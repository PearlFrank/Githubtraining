Changes done by Melvin
Code changed by Mathan